---
title: 暴走P图项目重构
categories: Android
tags:
  - 重构
  - 想法
abbrlink: db3d6b05
date: 2019-09-11 10:04:02
---

将MVP 代码重构 MVVM 总结

1、首先将整个工程 迁移到AndroidX（可做可不做，为了跟紧最新技术）
AndroidX 是 Google 推出了的，目的是为了统一 android.support.xxx 兼容包
主要迁移是利用Android Studio 的 Refacetor -> Migrate to AndroidX 操作
可以通过查看 gradle.properties 中 
```
android.useAndroidX=true
```
来确定是否迁移了AndroidX
最后查看app/build.gradle 中是否导入了相关的三方库
如
```
    implementation 'androidx.appcompat:appcompat:1.1.0'
    implementation 'androidx.recyclerview:recyclerview:1.0.0'
    implementation 'androidx.constraintlayout:constraintlayout:2.0.0-beta2'

    implementation "androidx.lifecycle:lifecycle-livedata-ktx:$rootProject.lifecycleVersion"
    implementation "androidx.lifecycle:lifecycle-extensions:$rootProject.lifecycleVersion"
    implementation "androidx.lifecycle:lifecycle-viewmodel-ktx:$rootProject.lifecycleVersion"
```
2、将MVP 转成 MVVM
根据项目架构（如包结构），可以对包结构做一个具体分析，
根据业务功能，划分数据包、功能包、适配器包、工具包等
然后在功能包内再 定义各个功能的viewmodel。

初始想法是 先将 XXXPresenter 重命名为 XXXViewModel，然后再根据具体的业务，使用LiveData观察会改变的数据类